!function(){const p={searchParamsInitial:window.location.search.slice(1),searchParamsPrev:window.location.search.slice(1),filterData:[]},f={addonSection:".dbtfy-collection-filters",actionsRow:".collection-template__actions-row",filtersDrawer:".dbtfy-collection-filters-drawer",form:".dbtfy-collection-filters-drawer__form",checkbox:".dbtfy-collection-filters-drawer__checkbox",removeFilter:".dbtfy-collection-filters-drawer__remove"},v={enabledAddon:"dbtfy-collection-filters-enabled",checkbox:"dbtfy-collection-filters-drawer__checkbox"};document.body.classList.add(v.enabledAddon);var e=document.querySelector(f.actionsRow);function h(){var e=document.querySelector(f.filtersDrawer);if(e){const o=e.querySelector(f.form);e.querySelectorAll(".price-range").forEach(e=>{const t=e.querySelector("input[type='range']:first-child"),n=e.querySelector("input[type='range']:last-child"),r=e.querySelector("input[name='filter.v.price.gte']"),a=e.querySelector("input[name='filter.v.price.lte']");r.addEventListener("change",e=>{e.preventDefault(),r.value=Math.max(Math.min(parseInt(r.value),parseInt(a.value||r.max)-1),r.min),t.value=r.value,t.parentElement.style.setProperty("--range-min",parseInt(t.value)/parseInt(t.max)*100+"%"),o.dispatchEvent(new Event("input"))}),a.addEventListener("change",e=>{e.preventDefault(),a.value=Math.min(Math.max(parseInt(a.value),parseInt(r.value||a.min)+1),a.max),n.value=a.value,n.parentElement.style.setProperty("--range-max",parseInt(n.value)/parseInt(n.max)*100+"%"),o.dispatchEvent(new Event("input"))}),t.addEventListener("change",e=>{e.stopPropagation(),r.value=t.value,r.dispatchEvent(new Event("change",{bubbles:!0})),o.dispatchEvent(new Event("input"))}),n.addEventListener("change",e=>{e.stopPropagation(),a.value=n.value,a.dispatchEvent(new Event("change",{bubbles:!0})),o.dispatchEvent(new Event("input"))}),t.addEventListener("input",e=>{t.value=Math.min(parseInt(t.value),parseInt(a.value||t.max)-1),t.parentElement.style.setProperty("--range-min",parseInt(t.value)/parseInt(t.max)*100+"%"),r.value=t.value,o.dispatchEvent(new Event("input"))}),n.addEventListener("input",e=>{n.value=Math.max(parseInt(n.value),parseInt(r.value||n.min)+1),n.parentElement.style.setProperty("--range-max",parseInt(n.value)/parseInt(n.max)*100+"%"),a.value=n.value,o.dispatchEvent(new Event("input"))})})}}e&&e.removeAttribute("hidden"),theme.helpers.loadComponent("drawer",()=>{var e,t;(e=document.querySelector(f.filtersDrawer))&&(new theme.Drawer("CollectionFiltersDrawer","left"),t=e.nextElementSibling,document.body.insertAdjacentElement("beforeend",e),document.body.insertAdjacentElement("beforeend",t),h(),function r(){const e=document.querySelector(f.filtersDrawer);if(!e)return;const t=e.querySelector(f.form);t.addEventListener("input",theme.helpers.debounce(e=>{n(e)},500));m();function n(e){if(e.preventDefault(),e.target.className===v.checkbox||e.target.closest("form")){const t=e.target.closest("form"),n=a(t);o(n,e)}}function a(e){const t=new FormData(e);return new URLSearchParams(t).toString()}function o(e,t,n=!0){p.searchParamsPrev=e;const r=document.querySelector(".collection-template").dataset.sectionId,a=`${window.location.pathname}?section_id=${r}&`+e,o=e=>e.url===a;p.filterData.some(o)?c(o,t):i(a,t),n&&l(e)}function l(e){history.pushState({searchParams:e},"",""+window.location.pathname+(e&&"?".concat(e)))}function i(n,e){fetch(n).then(e=>e.text()).then(e=>{const t=e;p.filterData=[...p.filterData,{html:t,url:n}],s(t),d(t),theme.helpers.loadComponent("imagesLazyloading",()=>{theme.imagesLazyLoading()}),r(),h(),m(),new theme.Drawer("CollectionFiltersDrawer","left",{isOpened:!0}),document.dispatchEvent(new CustomEvent("theme:addon:collection-filters:loaded"))})}function c(e,t){const n=p.filterData.find(e).html;s(n),d(n),theme.helpers.loadComponent("imagesLazyloading",()=>{theme.imagesLazyLoading()}),r(),h(),m(),new theme.Drawer("CollectionFiltersDrawer","left",{isOpened:!0}),document.dispatchEvent(new CustomEvent("theme:addon:collection-filters:loaded"))}function s(e){const t=document.querySelector(f.filtersDrawer);if(t){const n=(new DOMParser).parseFromString(e,"text/html"),r=n.querySelector(f.filtersDrawer);t&&r&&(t.classList.add("drawer--no-inner-animation"),t.innerHTML=r.innerHTML)}}function d(e){document.querySelector(".collection-template__products").innerHTML=(new DOMParser).parseFromString(e,"text/html").querySelector(".collection-template__products").innerHTML}function u(e){e.preventDefault();const t=-1===e.currentTarget.href.indexOf("?")?"":e.currentTarget.href.slice(e.currentTarget.href.indexOf("?")+1);o(t,e)}function m(){const e=document.querySelector(f.filtersDrawer);if(e){const t=e.querySelectorAll(f.removeFilter);t.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),u(e)})})}}}())})}();